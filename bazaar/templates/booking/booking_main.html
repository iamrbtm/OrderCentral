<!--
=========================================================
* Template for MasterList
=========================================================
Date: 1-12-23
Author:Jeremy Guill
Purpose:To provide one place for bookings of bazaars, flea markets, etc

Available Blocks
* title
* page_title
* stylesheets
* notifications
* main_content
* javascripts
=========================================================
-->
{% extends "base/base.html" %}

{% block title %}
    Booking
{% endblock title %}

{% block page_title %}
    Booking Main Page
{% endblock page_title %}

{% block stylesheets %}
    <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.13/js/dataTables.bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/dataTables.bootstrap.min.css">

    <script type="text/javascript">
        $(document).ready(function () {
            $('#documentlist').DataTable({
                "fixedHeader": true,
                "bPaginate": true,
                "bInfo": true,
                "orderMulti": true,
                "bAutoWidth": false,
                "colReorder": true,
                "responsive": true,
                "searchable": true,
            });
        });
    </script>
{% endblock stylesheets %}

{% block notifications %}
{% endblock notifications %}

{% block main_content %}
    <section class="section">
        <div class="m-4">
            <ul class="nav nav-tabs" id="myTab">
                <li class="nav-item">
                    <a href="#event-info" class="nav-link active" data-bs-toggle="pill">Event Info</a>
                </li>
                <li class="nav-item">
                    <a href="#key-dates" class="nav-link" data-bs-toggle="tab">Key Dates</a>
                </li>
                <li class="nav-item">
                    <a href="#checklists" class="nav-link" data-bs-toggle="tab">Checklists</a>
                </li>
                <li class="nav-item">
                    <a href="#documents" class="nav-link" data-bs-toggle="tab">Documents</a>
                </li>
                <li class="nav-item">
                    <a href="#notes" class="nav-link" data-bs-toggle="tab">Notes</a>
                </li>
                <li class="nav-item">
                    <a href="#breakdown" class="nav-link" data-bs-toggle="tab">Post Event Breakdown</a>
                </li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane fade show active" id="event-info">
                    <div class="card" style="width: 100%; height: 57vh">
                        <div class="card-body">
                            <div class="vpe-event-head">{{ record.event_name }} <a
                                    href="{{ url_for('masterlist.edit_single', id=record.id) }}"> <i
                                    class="bi bi-pencil-square"></i></a>
                            </div>

                            <div class="vpe-venue-head">{{ record.venue.name }} </div>
                            <div class="vpe-body">
                                {% if record.venue.address != None %}
                                    {{ record.venue.address }} {{ record.venue.city }}, {{ record.venue.state }}
                                    {{ record.venue.zipcode }}<br>
                                {% endif %}
                                {% if record.venue.phone != None %}
                                    {{ record.venue.phone }}
                                {% endif %}
                                {% if record.venue.website != None %}
                                    | {{ record.venue.website }}
                                {% endif %}
                            </div>

                            <div class="vpe-venue-head">{{ record.promoter.name }}</div>
                            <div class="vpe-body">
                                {% if record.promoter.address != None %}
                                    {{ record.promoter.address }} {{ record.promoter.city }},
                                    {{ record.promoter.state }}
                                    {{ record.promoter.zipcode }}<br>
                                {% endif %}
                                {% if record.promoter.phone != None %}
                                    {{ record.promoter.phone }}
                                {% endif %}
                                {% if record.promoter.website != None %}
                                    | {{ record.promoter.website }}
                                {% endif %}
                                <div class="vpe-venue-head">People</div>
                                {% for person in persons %}
                                    {{ person.name }}
                                    {% if person.email != None %}
                                        -<a class="vpe-body"
                                            href="mailto:{{ person.email }}">{{ person.email }}</a>
                                    {% endif %}
                                    {% if person.phone != None %}
                                        -<a class="vpe-body"
                                            href="tel:{{ person.phone }}">{{ person.phone }}</a>
                                    {% endif %}
                                    <br>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div><!-- END Event Info -->

                <div class="tab-pane fade" id="key-dates">
                    <div class="card" style="width: 100%; height: 57vh">
                        <div class="card-body">
                            <div class="card-body">
                                <div class="vpe-venue-head">Key Dates</div>
                                <div class="vpe-body">
                                    <div>Application Opens RETURN</div>
                                    <div>Application Opens NEW</div>
                                    <div>Application Deadline</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div><!-- END Key Dates -->

                <div class="tab-pane fade" id="checklists">
                    <div class="card" style="width: 100%; height: 57vh">
                        <div class="card-body">
                            <div class="card-body">
                                <div class="vpe-venue-head">Check Lists</div>
                            </div>
                        </div>
                    </div>
                </div><!-- END Checklists -->

                <div class="tab-pane fade" id="documents">
                    <div class="card" style="width: 100%; height: 57vh">
                        <div class="d-flex mb-3">
                            <div class="me-auto">
                                <div class="vpe-venue-head p-3">Documents</div>
                            </div>
                            <div class="p-3">
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                        data-bs-target="#add_doc">
                                    Add Document
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="documentlist" class="table table-striped table-responsive table-borderless">
                                <thead>
                                <th>Filename</th>
                                <th>File Type</th>
                                <th>Size</th>
                                <th>Upload Date/Time</th>
                                <th></th>
                                <th></th>
                                </thead>
                                <tbody>
                                {% for key, value in files.items() %}
                                    <tr>
                                        <td>
                                            {% if value['filetype'] == ".pdf" %}
                                                <i class="bi bi-file-earmark-pdf-fill"></i>
                                            {% elif value['filetype'] == ".txt" %}
                                                <i class="bi bi-file-text-fill"></i>
                                            {% elif value['filetype'] == ".csv" %}
                                                <i class="bi bi-filetype-csv"></i>
                                            {% elif value['filetype'] == ".docx" %}
                                                <i class="bi bi-file-earmark-word-fill"></i>
                                            {% elif value['filetype'] == ".doc" %}
                                                <i class="bi bi-file-earmark-word-fill"></i>
                                            {% elif value['filetype'] == ".xlsx" %}
                                                <i class="bi bi-file-earmark-excel-fill"></i>
                                            {% else %}
                                                <i class="bi bi-file-image"></i>
                                            {% endif %}
                                            {{ value['file'] }}</td>
                                        <td>{{ value['filetype'] }}</td>
                                        <td>{{ value['size'] }}</td>
                                        <td>{{ value['created'] }}</td>
                                        <td><a href="{{ value['editlink'] }}"><i
                                                class="bi bi-eye-fill"></i></a>
                                        </td>
                                        <td><a href="{{ value['deletelink'] }}"><i class="bi bi-x-circle-fill"></i></a>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div><!-- END Documents -->

                <div class="tab-pane fade" id="notes">
                    <div class="card" style="width: 100%; height: 57vh">
                        <div class="card-body">
                            <h5 class="card-title">Notes</h5>
                        </div>
                    </div>
                </div><!-- END Notes -->

                <div class="tab-pane fade" id="breakdown">
                    <div class="card" style="width: 100%; height: 57vh">
                        <div class="card-body">
                            <h5 class="card-title">Post Event Breakdown</h5>
                        </div>
                    </div>
                </div><!-- END Post Event Breakdown -->
            </div>
        </div>
    </section>

    <!-- Modal -->
    <div class="modal fade" id="add_doc" tabindex="-1" aria-labelledby="add_docLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="add_docLabel">Add Document to {{ record.event_name.title() }}
                        Booking</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form class="form" method="post" action="{{ url_for('booking.adddoc', id=record.id) }}"
                      enctype="multipart/form-data">
                    <div class="modal-body">
                        <div>
                            <label for="file" class="form-label">Select File</label>
                            <input class="form-control form-control-lg" name="file" id="file" type="file">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Upload</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock main_content %}

{% block javascripts %}
{% endblock javascripts %}